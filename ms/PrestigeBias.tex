\documentclass[12pt]{extarticle}
\usepackage{geometry}
\geometry{
a4paper,
total={170mm,257mm},
left=20mm,
top=20mm,
headheight=12pt
}

%\usepackage[parfill]{parskip} % Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}
\usepackage{amsthm, amsmath, amssymb}
\usepackage[font=small]{caption, subcaption}
\usepackage{setspace}\onehalfspacing
\usepackage[loose,nice]{units}
\usepackage{array}
\usepackage[super]{nth}
\usepackage{graphicx}
\usepackage{float}
\usepackage{cleveref}
\usepackage{subcaption}
\usepackage{mathtools}
\usepackage[round,colon,authoryear]{natbib}
\usepackage[all]{nowidow}
\usepackage{wrapfig}
\usepackage{pdfpages}
\usepackage{authblk}

% line numbers
\usepackage[displaymath, mathlines]{lineno}
 \renewcommand\linenumberfont{\normalfont\small\sffamily}
\linenumbers
\modulolinenumbers[2]

% math stuff
\DeclareMathOperator*{\E}{{\rm I\kern-.3em E}}
\newcommand*{\tr}{^\intercal}
\let\vec\mathbf
\newcommand{\matrx}[1]{{\left[ \stackrel{}{#1}\right]}}
\newcommand{\diag}[1]{\mbox{diag}\matrx{#1}}
\newcommand{\goesto}{\rightarrow}
\newcommand{\dspfrac}[2]{\frac{\displaystyle #1}{\displaystyle #2} }
\newtheorem{theorem}{Theorem}
\newtheorem{corollary}{Corollary}
\newtheorem{lemma}{Lemma}
\newtheorem{remark}{Remark}
\newtheorem{result}{Result}
\renewcommand\qedsymbol{} % no square at end of proof
\newcommand{\cl}{\mathbf{L}}
\newcommand{\cj}{\mathbf{J}}
\newcommand{\ci}{I}

% title page stuff
\title{Prestige as a Driving Force in Cultural Transmission}

\author[1]{Saar Egozi}
\author[2,3,*]{Yoav Ram}
\affil[1]{School of Computer Science, Reichman University, Herzliya, Israel}
\affil[2]{School of Zoology, Faculty of Life Sciences, Tel Aviv University, Tel Aviv, Israel}
\affil[3]{Sagol School of Neuroscience, Tel Aviv University, Tel Aviv, Israel}
\affil[*]{Corresponding author: yoav@yoavram.com}
 
\date{\today}


\begin{document}
\maketitle

\begin{abstract}
Copying role-models can be an efficient method of acquiring knowledge. Here, we study the effects of prestige as a cultural transmission bias in cultural-evolution model. A common bias when choosing a role-model to copy is success bias, i.e copying whoever appears more successful. This bias depends on the performance of the role-model alone, without other factors. We propose an additional bias that may be prevalent in cultural transmission: influence bias, which is evaluated by the number of individuals that have already copied a specific role-model . We combine these biases together to a prestige bias and analyze its effects on the evolutionary dynamics of the population using mathematical analysis and stochastic simulations. We find analytic approximations to our model, facilitating further mathematical analysis and reducing the computational complexity of the simulations. We validate these approximations using simulations, and demonstrate their robustness to model assumptions.
For a dichotomous cultural trait, we find  an approximation to the fixation probability and the fixation time of an invading advantageous cultural trait, in both a constant and changing environment, which resembles Kimura's classical formulas.
These approximations show that influence effectively reduces the population size. % TODO reduce or increase?
We also find that influence accelerates the evolutionary dynamics, as can be expected in a \textit{rich-getting-richer} process.
Our model may provide a better description of how human cultural transmission, 
especially in the last years where social networks are very popular. % TODO to discuss this last sentence
Further work is needed to test if this model could predict various phenomena in human cultural evolution when extended with the effects of selection and innovation.
\end{abstract}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Introduction}

\paragraph{Cultural transmission.}
In cultural transmission, individuals transmit cultural traits (i.e., behavior, beliefs, norms) to one another, typically via learning and demonstrating \citep{transmissionVectorsBook}.
Examples for cultural traits in humans are behavioral patterns, such as personalities and habits, transmitted via both verbally and by observations. % TODO reference
Although cultural transmission is most common in humans, it is also observed in other animals such as chimpanzees \citep{chimpsPrestige, chimpsCopy}. % TODO but also birds, Cetacea (Whitehead, PNAS 2017)
In elephants, \citet{elepahntsRepo} showed that once a matriarch is removed from the group, the group's survival instincts are inferior and that ``the possession of enhanced discriminatory abilities by the oldest individual [matriarch] in a group can influence the social knowledge of the group as a whole.''
By playing audio recordings of African elephants, they showed that groups with a matriarch recognize and react better to hostile or friendly calls than groups without a matriarch.
\citet{fliesPaper} showed that choice of oviposition site in fruit flies is culturally transmitted: inexperiences flies that spent some time with experienced flies chose the same type of oviposition site even without directly observing this behavior. How the information is transmitted is still an open question, but it has been suggested that flies may use olfactory cues like other animals, such as rodents and bees.

\paragraph{Direction of transmission.}
Similar to genetic transmission, culturally transmitted traits can be transmitted from parents to offspring, and their effects of can be physiological rather than behavioral.
For example, parents can "teach" their children to be strong or tall, within some biological limits, by instructing them to maintain a specific diet and engage in physical activity.
Contrary to genetic transmission, cultural transmission can be non-vertical, that is, traits may be transmitted via social learning from non-parental individuals, and even unrelated individuals such as teachers, leaders, media, or any stranger that interacts with the learning individual.
Thus, cultural transmission may combine vertical transmission, where parents transmit to their offspring; oblique transmission, where adults transmit traits to unrelated offspring; and horizontal transmission, where peers from the same age cohort transmit to one another. 
Vertical transmission is also possible in the opposite direction: parents may copy traits from their offspring (e.g playing video games)\citep{transmissionVectorsBook,transmissionVectors}.  % TODO did they suggest video games or did they have some other trait? not sure I want to mention video games...

\paragraph{Transmission biases.}
In social learning, transmission biases cause a trait to have a disproportionate probability to be transmitted compared to its frequency in the population.
Although more common in cultural transmission, transmission biases do occur in genetic transmission. For example, \textit{wtf genes} in yeast bias their transmission to the gamete by secreting a long life-expectancy poison together with a short life-expectancy antidote, so that a gamete without the gene will perish because the poison will outlive the antidote \citep{wtfGene}.
Importantly, even when a trait is disfavored by natural selection, it may still spread in a population due to transmission biases that are strong enough to overcome selection \citep[Ch. 8 pg. 279]{evolutionBook}.
% TODO we have an example of this in Dor's paper, in which cooperation can evolve due to horizontal transmission bias even when the benefit is zero:
% 1. Cohen, D., Lewin-Epstein, O., Feldman, M. W. & Ram, Y. Non-vertical cultural transmission, assortment and the evolution of cooperation. Proc. R. Soc. B Biol. Sci. 288, 20203162 (2021).

\paragraph{Success bias.}
\citet{strategiesPaper} have conducted a tournament between learning strategies. Each strategy defines when individuals observe and copy from others, and when they engage in individual learning, in which an individual learns a cultural trait on his own. The best strategies had a high frequency of social learning relative to individual learning, even when the transmission error was almost 50\%. It is important to note that all of the strategies included some frequency of individual learning. 
%The authors suggested that success-biased social transmission contribute more to the general success of the population than individual learning. % TODO how is the last sentence related to the results of the tournament? did the best strategies use success-bias? it is not clear

% TODO do we need the following paragraph? it doesn't say much, and the paragraph after it covers "different type of success evaluation", so what is this paragraph doing?
%\citet{complexityPaper} define different types of transmission biases based on success. They define several types of role-model choice methods, all assuming that the copier correctly identifies the successful role-models.

\paragraph{Evaluating success.}
\citet[Ch. 5]{evolutionBook} suggest that the evaluation of success can be divided into three groups: \textit{direct bias}, \textit{indirect bias} and \textit{frequency-dependent bias}.
A direct bias occurs when a variation of a trait is more attractive than others, and is evaluated by \textit{directly} testing the variation of the trait.
For example, an individual observing a Ping-Pong match can attempt both of the observed paddle grips to determine which grip is better.
An indirect bias occurs when an individual uses the value of one trait to determine the attractiveness of another, so it \textit{indirectly} evaluates the attractiveness of the role-model.
For example, an observer may copy the paddle grip of the Ping-Pong player who scored more points in the match, thus indirectly evaluating the grip by the points scored.
A frequency-dependent bias occurs when an individual has a probability to copy a variant of the trait that higher or lower than trait's frequency among demonstrators. 
For example, when an individual is 80\% likely to copy the common paddle grip even when only 60\% of the population is using it, it is said to be frequency-biased, or in this case, conformist.
Frequency bias could be negative, i.e., non-conformist bias. 
Conformity and non-conformity are well-known biases in cultural transmission \citep{conformism}, and its effect on cultural evolution have been studied with both models (Denton 2020 PNAS; Denton TPB 2021) and experiments \citet{negativeFrequency} 
% TODO references for the above
% 1. Denton, K. K., Ram, Y. & Feldman, M. W. Conformity and content-biased cultural transmission in the evolution of altruism. Theor. Popul. Biol. (2021) doi:10.1016/j.tpb.2021.10.004.
% 2. Denton, K. K., Ram, Y., Liberman, U. & Feldman, M. W. Cultural evolution of conformity and anticonformity. Proc. Natl. Acad. Sci. U. S. A. 202004102 (2020) doi:10.1073/pnas.2004102117.
 
\paragraph{Prestige.}
Prestige means having a good reputation or high esteem, therefore does not directly signify success (although it may imply it), making it an indirect bias.
Both \citet[Ch. 8]{evolutionBook} and \citet{complexityPaper} suggest that prestige biases are probably more common in humans than success biases.
\citet[Ch. 8]{evolutionBook} add that maladaptive traits may spread widely in a population if indirect biases are strong enough.
They suggest that such biases could lead to a runaway process caused by a cultural equivalent of sexual selection \citep{sexualSelectionBook}.
On the other hand, \citet{fijian_social_bias} suggest that prestige biases, over generations, can lead to cultural adaptations, and that although prestige can lead to maladaptive traits spreading in the population, it can also accelerate the spread of adaptive traits.
Prestige is often mentioned in the cultural-evolution literature, but seldom modeled, although \citet{evolutionBook} have modeled prestige via success bias. % TODO is this correct?

\paragraph{Influence bias.}
Today, social media provides an easy way to estimate the influence individuals have over others, and therefore may have a major effect on human decision making. For example, the number of "followers" a person has on social networks such as \textit{Facebook} or \textit{Instagram} may significantly affect how his beliefs are perceived by the population. % TODO this must have some reference in the literature.
Here we propose an indirect bias that we call \textit{influence bias}, in which the choice of a role-model depends on the the choices made by other individuals that have already chosen a role-model. 
This is a context bias, % TODO right?
 which depends on the role-model rather than the trait, in contrast to frequency biases such as conformity, which depend on the frequency of a trait in the population or in a sample of role-models. 
We define a model for prestige bias that combines both success and influence biases, provide analytic approximations for this model, and analyze its dynamics.
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Models and Methods}

%A \textit{Wright–Fisher model} describes an evolutionary process with random genetic. This model assumes non-overlapping generations such that the entire population is replaced in every generation by the offspring population. The parent of each offspring is independently drawn at random from the parental generation.
%A \textit{Moran model} also describes an evolutionary process with drift, but assumes overlapping generations. At each time step, one individual is chosen to reproduce and one individual is chosen to die. 

We begin with a continuous trait model with indirect bias suggested by \citet{evolutionBook}, develop an extension with influence bias, and then develop a model with a dichotomous trait.
We implemented our stochastic models and approximations, performed statistical analyses, and produced figures using Python with NumPy and Matplotlib. % TODO references: 
%- Van Rossum, G. & others. Python Programming Language. in USENIX Annual Technical Conference (2007).
%- van der Walt, S., Colbert, S. C. & Varoquaux, G. The NumPy Array: A Structure for Efficient Numerical Computation. Comput. Sci. Eng. 13, 22–30 (2011). 
%- Hunter, J. D. Matplotlib: A 2D Graphics Environment. Comput. Sci. Eng. 9, 90–95 (2007).
Source code is available at % TODO GitHub link; currently it is private but will be public when paper is accepted.

\subsection*{Continuous trait}
We follow the model of \citet{evolutionBook}, assuming only oblique transmission of the indicator trait and omitting the indirect trait in order to reduce model complexity. 
We consider a population of $N$ individuals, described by a single indicator trait with a continuous value.
Each generation, $N$ naive individuals, or copiers, choose an individual from the previous generation, or role-models, from which they will copy their trait. Similar to a Wright–Fisher model, we assume non-overlapping generations such that the entire population is replaced in each generation.
The population at time $t$ can be described by $\vec{A}(t)=\big(A_{1}(t), \ldots, A_{N}(t)\big)$ where $A_{i}(t)$ is trait value of individual $i$ at time $t$. We assume the initial population is drawn from a standard normal distribution, $\vec{A}(0) \sim N(0,1)$ .
Cultural transmission is modeled by a function $F$ such that 
\begin{equation}\label{eq:transmission}
A_{i}(t+1) = F_i(\vec{A}(t)) \;.
\end{equation}

\paragraph{Success bias.}
\citet[Ch.8, p.247-249]{evolutionBook} describe a blended transmission algorithm by defining $F$ as a weighted average of the traits of all role-models, 
\begin{equation}\label{eq:boydF}
% TODO I changed X to A, and Aij to Aj, verify its ok
F_i(\vec{A}) = \sum_{j=1}^N G_{i,j}\cdot A_{j} \;, 
\end{equation}
where $G_{i,j}$ is the success bias of role-model $j$ in the eyes of copier $i$,
\begin{equation}\label{eq:boydG}
G_{i,j} = \frac{\beta(A_{i,j})}{\sum_{k=1}^{N} \beta(A_{i,k})} \;,
\end{equation}
$A_{i,j}$ is the absolute indicator trait value copier $i$ estimates for role-model $j$ with some error $e_i \sim N(0,\frac{1}{\eta^2})$,
\begin{equation}\label{eq:relativeIndicator}
A_{i,j} = A_j + e_i,
\end{equation}
and $\beta(\cdot)$ is the bias function that quantifies the success bias of a role-model,
\begin{equation}\label{eq:success_bias}
\beta(A_{i,j}) = b \cdot \exp{\Big(-\frac{(A_{i,j} - \hat{A})^2}{2J}\Big)},
\end{equation} 
with $\hat{A}$ as the arbitrary optimal indicator value, and $J$ and $b$ as parameters that control the bias strength.
Therefore, $G_{i,j}$ is a relative success score that copier $i$ assigns to role-model $j$, equivalent to relative fitness in evolutionary-genetic transmission models.

\citet{evolutionBook} note that the deterministic blended transmission algorithm they use has alternatives. We thus develop a similar stochastic model with transmission from a single random role-model. Instead of \cref{eq:boydF}, we define the transmission function $F$ as a random variable with its distribution given by 
\begin{equation}\label{eq:ourF}
\Pr\big(F_i(\vec{A}) = A_{j}\big) = G_{i,j} \;,
\end{equation}
such that $G_{i,j}$ gives the probability of copier $i$ to choose to copy the trait of role-model $j$.

\paragraph{Influence bias.}
Here we introduce a new element to the model.
We assume that in each generation, copiers choose their role-models one by one.
We denote $K_{i,j}$ as the number of copiers that chose role-model $j$ after copier $i$ chose a role-model. Thus, $i$ out of $N$ copiers already chose a role-model, $\sum_{j=1}^N{K_{i,j}} = i$, and there are $N-i$ copiers that have yet to choose a role-model.
The stochastic process of role-model choice, 
\begin{equation} \label{eq:process}
\big\{\vec{K}_i = (K_{i,1}, \ldots, K_{i,N}) \big\}_{i=1}^N \;,
\end{equation}
is described by the recurrence equation
\begin{equation} \label{eq:recurrence}
K_{i,j} = K_{i-1,j} + S_{i,j}, \quad i,j=1,2,\ldots,N \;,
\end{equation}
where $S_{i,j}=1$ if the $i$-th copier chose role-model~$j$ and 0 otherwise, and the initial state is $K_{0,j}=0$.

Following \cref{eq:ourF}, the probability that the $i$-th copier chose role-model $j$ is given by the prestige of role-model $j$ in the eyes of copier $i$,
\begin{equation}\label{eq:recPrestige}
Pr(S_{i,j}=1 \mid S_{1,j},S_{2,j},...,S_{i-1,j}) = G_{i,j} \;.
\end{equation}
The prestige $G_{i,j}$ of role-model~$j$ in the eyes of copier~$i$ is determined by the estimated biased indicator value $\beta(A_{i,j})$ and the number of copiers that chose role-model $j$ before copier $i$, $K_{i-1,j}$, replacing \cref{eq:boydG} of \citet{evolutionBook} with
\begin{equation}\label{eq:prestige}
G_{i,j} = \frac{\alpha_j \cdot \beta(A_{i,j}) + (1-\alpha_j) \cdot K_{i-1,j}}{W_i} \;.
\end{equation}
Here, the weight $\alpha_j$ is a characteristic of role-model~$j$ that determines the relative significance of success and influence in his prestige, the indicator value of role-model $j$ estimates by copier $i$, $A_{i,j}$, remains as in \cref{eq:relativeIndicator}, and $W_i$ is a normalizing factor that sums the numerator over all role-models ($1\le j \le N)$ to ensure $\sum_{j=1}^{N}{G_{i,j}}=1$.
%\begin{equation}
%W_i = \sum_{j=1}^N{\alpha_j \cdot \beta(A_{i,j}) + (1-\alpha_j) \cdot K_{i-1,j}}.
%\end{equation}


\subsection*{Dichotomous trait}
To allow for mathematical analysis of the model, we introduce a simplified version where the indicator trait only has two phenotypes: the optimal phenotype $\hat{A}$ and the sub-optimal phenotype $A$. 
All role-models with the same phenotype will contribute to the probability of that phenotype to be transmitted, and thus influence is determined by the number of copiers that have already chosen a role-model with either phenotype.
Therefore, the probability of the $i$-th copier to copy phenotype $A$ is
% based on \cref{eq:copier_choose} is % TODO you refer an equation that did not yet appear!
\begin{equation}\label{eq:binary-model}
P_{i,A} = \frac{(N-X)\alpha'\beta(A) + K_{i,A}}{i-1 + (N-X)\alpha'\beta(A) + X\alpha'\beta(\hat{A})} = \frac{(N-X)\alpha'\beta(A) + K_{i,A}}{i-1 + (N-X)\alpha'\beta(A) + \alpha'X} % TODO should it be G_{i,A} rather than P_i,A ?
\end{equation}
where $X$ is the number of role-models with trait $\hat{A}$ and $K_{i,A}$ is the number of copiers that already chose $A$ when copier $i$ chooses a role-model.
% TODO what is alpha' ?
Initially, we assume the population has a single individual with phenotype $\hat{A}$ and $N-1$ individuals with phenotype $A$. The rest of the details follow the continuous trait model.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Results}
\subsection*{Approximations}
Our model is defined by two nested stochastic processes. Change over multiple generations is described by the phenotype distribution at each generation, $\{\vec{A}(t)\}_t$. The transition from one generation to the next is described by the number of copiers each role-model has after $i$ copiers have chosen a role-model, $\{\vec{K}_i\}_{i=1}^N$.
We emphasize that the models are nested: $\vec{A}(t+1)$ can be computed from $\vec{A}(t)$ by evaluating $\vec{K}_{N}$. However, the former requires iterating over \cref{eq:recurrence,eq:recPrestige}. Thus, we sought to find an equivalent stochastic process that has the same joint distribution as $\vec{K}_{N}$. 
We found two approximations such processes, summarized here and explained in detail below:
\begin{enumerate}
\item 
The number of copiers of a specific role-model at each step, $K_{i,j}$, follows the {\em generalized binomial distribution}~\citep{GBD} and therefore,
\begin{enumerate}\item the expected number of copiers of role-model~$j$ equals its prestige in the eyes of the first copier, multiplied by the total number of copiers, that is,
$\E[K_{N,j}] = N \cdot G_{1,j}$ if trait estimation error is uniform for all copiers ($e=e_i$ for $i=1, \ldots, N$).
\item the expected number of copiers of each role-model equals its relative biased indicator value, similar to the role of relative fitness in population-genetic models, that is, $\E[K_{N,j}] = \beta(A_j+e) / \overline{\beta}$ if $\alpha$ is uniform for all role-models ($\alpha=\alpha_k$ for $k=1,\ldots,N$), where $\overline{\beta}=1/N \sum_{j=1}^{N}{\beta(A_j+e)}$ is the population mean estimated indicator value. 
\end{enumerate}
\item The role-model choice process, $\{\vec{K}_{i}\}_{i=1}^{N}$, is equivalent to a {\em P\'{o}lya urn} model if trait estimation error is uniform for all copiers ($e=e_i$ for all $i=1, \ldots, N$). 
Therefore, the number of copiers of all role-models, $\vec{K}_i = (K_{i,1}, \ldots, K_{i,N})$, follows a Dirichlet-Multinomial distribution,
$\vec{K}_i \sim \mathit{DM}\big(N, \vec{G}_1\big)$, where $\vec{G}_1 = (G_{1,1}, \ldots, G_{1,N})$ is the prestige vector of all role-models in the "eyes" of the first copier.
Note that here $G_{i,j}$ is only a function of the indicator values $A_j$ and the weights $\alpha_j$, as the estimation error is uniform. % TODO correct? anything else need to be assumed?
\end{enumerate}


\subsection*{Generalized Binomial Distribution}
The generalized binomial distribution (GBD) emerges from a series of dependent Bernoulli trials (in contrast to the standard binomial distribution in which trials are independent) and is parameterized by $GBD(n, p, \theta)$ where $n$ is the number of trials, $p$ is the probability of success of the first trial, and $\theta$ is the correlation between trials ($\theta=0$ gives the standard binomial distribution).

\begin{result}[GBD approximation]
The number of copiers of role-model $j$ after $i$ copiers have chosen a role-model follows the GBD, $K_{i,j} \sim GBD(i,\alpha_i\cdot\beta(A_j+e))$ if $e_i=e$ for all role-models $i=1, \ldots, N$. 
\end{result}

\begin{proof}
We denote $Q_j(k,i)=P(K_{i,j} = k \mid K_{i-1,j})$ as the probability that exactly $k$ out of $i$ copiers choose role-model $j$ given $K_{i-1,j}$ our of $i-1$ copiers chose role-model $j$. 
Using conditional probability and \cref{eq:recurrence},
\begin{equation}\label{recursive}
Q_j(k,i) = P_j(S_{i,j}=1 | k-1,i-1) \cdot Q_j(k-1,i-1) + P_j(S_{i,j} =0 | k,i-1) \cdot Q_j(k,i-1),
\end{equation}
where $S_{i,j} =1 $ when the $i$-th copier chooses role-model $j$.
\Cref{recursive} is equivalent to eq.~(2.1) by \citet{GBD}, which completes the proof.
%$Q_j(k,N)$ is the probability that $k$ out of $N$ copiers choose role-model $j$ at the end of the process, which by our previous notation is $k=K_{N,j}$. % TODO do you need this sentence?
\end{proof}

\begin{corollary}
$\E[K_{N,j}] = N \cdot G_{1,j}$.
\end{corollary}

\begin{proof}
\citet[eq.~(2.3)]{GBD} show that 
$\E[k] = N \cdot Q_j(1,1)$ (modified from their notation).
$Q_j(1,1)$ is the initial probability to choose role-model $j$, before any role-model choices are made.
$Q_j(1,1) = G_{1,j}$ by definition, which completes the proof.
\end{proof}

\begin{corollary}
$\E[K_{Nj}] = \alpha_j \cdot \beta(A_j+e) / \overline{\alpha \cdot \beta(A+e)}$, where the averaging in the denominator is over the role-models index, $j$.
\end{corollary}

\begin{proof}
The initial prestige of role-model $j$ based on \cref{eq:prestige} is
\begin{equation}\label{eq:initial_prob}
G_{1,j} = \frac{\alpha_j\cdot\beta(A_j+e)}{\sum\limits_{m=1}^{N} \alpha_m\cdot\beta(A_m+e)} \;.
\end{equation}
The denominator of \cref{eq:initial_prob} can also be formulated as:
\begin{equation}\label{eq:denominator}
 \sum\limits_{m=1}^{N}\alpha_m\beta(A_m+e) = N \cdot \overline{\alpha \cdot \beta(A+e)} \;,
\end{equation}
where $\overline{\alpha\beta(A+e)}$ is the mean value of $\alpha_m\cdot\beta(A_m+e)$ for all $m$.
Using \cref{eq:denominator} we get, % TODO something is missing here? how did you get E[KNj] to relate to the previous two equations?
\begin{equation}
\E[K_{Nj}] = \alpha_j \cdot \beta(A_j+e) \bigg/ \overline{\alpha \cdot \beta(A+e)} \;,
\end{equation}
completing the proof.
\end{proof}

The special case where the weight is uniform for all role-models ($\alpha = \alpha_j$ for $j=1,\ldots, N$) is interesting, because we can evaluate the expected number of copiers using a linear equation
\begin{equation}
\E[K_{Nj}]= N\cdot\frac{\alpha\cdot\beta(A_j+e)}{\sum\limits_{m=1}^{N}\alpha\cdot\beta(A_m+e)} =\beta(A_j+e) \bigg/ \overline{\beta(A+e)} \;,
\end{equation}
where the only variable is $A_j+e$, because $\overline{\beta(A+e)}$ is the mean of the distribution we draw the indicator values from, modified by some constant parameters of $\beta$.
We can then denote $L = 1/\overline{\beta(A+e)}$ and write
\begin{equation}\label{eq:linearEq}
\E[K_{Nj}] = L\cdot \beta(A_j+e) \;.
\end{equation}


\subsection*{Dirichlet-Multinomial Distribution}

\begin{remark}
\textit{Pólya urn model}  is a stochastic process that is defined as such: 
The process consists of $N$ draws from an urn with an initial amount of colored balls of $M$ colors. When a ball is drawn, it is then placed back in the urn together with an additional new ball of the same colour.\\
Let $\vec{U_i} = \{u_{i,1},u_{i,2},...,u_{i,M}\}$  where $u_{i,j}$ is the number of balls of the $j$-th color in the urn after $i$ draws.
Let $S_{i,j}=1$ when drawing a $j$ colored ball on the $i$-th draw, and $0$ otherwise. The probability that $S_{i,j}=1$ given $\vec{U_{i-1}}$ is:
\begin{equation}\label{polya}
\begin{split}
P(S_{i,j} = 1 | \vec{U_{i-1}}) & = \frac{u_{i-1,j}}{\sum\limits_{m=1}^{M} u_{i-1,m}} = \frac{o_j + w_{i-1,j}}{\sum\limits_{m=1}^{M} o_m + w_{i-1,m}}\\
 & = \frac{o_j + w_{i-1,j}}{i-1 + \sum\limits_{m=1}^{M} o_m}
\end{split}
\end{equation}
where $o_j$ is the initial number of balls of the colour $j$ in the urn, and $w_{i,j}$ is the number of new balls that were added to the urn after $i$ draws of the color $j$.
\end{remark}

\begin{result}[Pólya urn model]
$\big\{\vec{K}_i\big\}_{i=1}^N$ is equivalent to a \textit{Pólya urn model} when $e=e_i=e_j$ and $\alpha=\alpha_j=\alpha_i$ for all $i,j \in N$.
\end{result}

\begin{proof} 
We denote $\alpha'$ as the odds ratio between the weights of the indicator and the influence ($\alpha'=\frac{\alpha}{1-\alpha}$). 
Using \cref{eq:prestige} we get:
\begin{equation}\label{eq:copier_choose}
\begin{split}
G_{i,j} & = \frac{\alpha\cdot \beta(A'_j) + (1-\alpha) \cdot K_{i-1,j}}{W_i} \cdot \frac{1-\alpha}{1-\alpha} \\
&= \frac{\alpha'\beta(A'_j) + K_{i-1,j}}{\sum\limits_{m=1}^{N} \alpha'\beta(A'_m) + K_{i-1,m}}\\
& =\frac{\alpha'\beta(A'_j) + K_{i-1,j}}{i-1 + \sum\limits_{m=1}^{N} \alpha'\beta(A'_m)}
\end{split}
\end{equation}
We see that \cref{polya} and \cref{eq:copier_choose} are equivalent when setting $M=N$, $o_j = \alpha'\beta(A'_j)$, $w_{i,j} = K_{i,j}$, completing the proof.
\end{proof} 

\begin{remark}
In their paper, \citet[section 2]{dirichlet} prove that the proportion of different colored balls in a \textit{Pólya urn model} will converge to the Dirichlet distribution as the number of draws approaches infinity, based on \textit{Martingale Convergence Theorem} \citep{martingaleBook}.
We therefore have an approximation for the relative "weight" or the proportion each role-model has when evaluated as a role-model. Drawing from a Multinomial distribution where the parameters are the modified weights gained from the Dirichlet distribution is viable for selecting the role-model for the next generation.
We can therefore sample from a Dirichlet-Multinomial distribution to approximate how many copiers each of the role-models will have:
$\vec{K_i} \sim DM(N,\vec{G_1})$.
\end{remark}

\paragraph{Numeric validation:} We showed our process is DM (Dirichlet-Multinomial) distributed when there are no errors when copying or evaluating the traits, and when $\alpha$ is homogeneous in the population. To support our proof, we tested our approximation empirically using computer simulations.
To test our hypothesis, we used a \textit{goodness of fit} method known as \textit{Pearson's chi-squared test}. In this test, one can reject or accept the null hypothesis, which in our case is the hypothesis that the simulations results were drawn from a DM distribution.

To use this test, we ran many simulations of our original model, and used the mean distribution of copiers. This mean distribution is our observed distribution, and we tested it with the DM expected distribution, using said chi-squared test.
We tested multiple variations of the trait weight parameter ($\alpha$).

In all our tests, the p-value was \textbf{1}. This means that the probability to reject the null hypothesis is essentially nonexistent (the usual threshold for a p-value needed to reject $H_0$ is 0.05 or lower). 
In addition, we found out that for high $\alpha$ values (above 0.5), very few simulations are needed to reach p-value 1. (less than five simulations for $\alpha=0.9$, and less than 20 for $\alpha=0.7$)
For very low $\alpha$ values, which means very high influence weight, the number of simulations needed was 100, which is still a relatively small amount.
To verify our codes results, we also ran the test for different distributions, for example the uniform distribution (all role-models have exactly one copier).

All these tests resulted in a p-value 0, which means we can likely reject $H_0$ for these distributions, as expected.

Once we validated our proof for a single iteration of the model, we went on to more complex validations for the entire model.


\subsection*{Numeric comparisons}
We're interesting in studying the difference between the real binary model as we defined in \cref{eq:binary-model}, and the Dirichlet-Multinomial approximation. Specifically, we're interesting in the fixation probability of the favored trait ($\hat{A}$) and its time to fixation.

\begin{figure}
    \includegraphics[width=\linewidth]{../figures/binary/num_sims.pdf}
  \caption{The number of simulations needed to get a good approximation. At $1,000$ the approximation is good enough. Error bars represent 95\% confidence interval. Population size $N=1000$, $\alpha=0.5$, $J=1$, $\hat{A}=1$,$A=0.7$, $\beta(A)=0.956$.}	
  \label{fig:num_sims}
\end{figure}


The first step was to find the number of simulations needed to sufficiently approximate the real model with the DM approximation. From \cref{fig:num_sims} we see that $1000$ simulations or higher is enough.

The next step was to see how the observed metrics (fixation probability and time) varies when relaxing our assumptions we used to prove the DM approximation.
First we relaxed our assumption of no mutation. To include mutation in the binary model, it needs to be redefined, since in the original model it was based on the fact the traits are drawn from a continuous scale. In the binary model mutation will be manifested as an error when evaluating the bias itself. This is easily done by using a heterogeneous $J$ parameter, which controls the strength of the success bias in \cref{eq:success_bias}.


\begin{figure}
    \includegraphics[width=\linewidth]{../figures/binary/full_vs_dm_mutation.pdf}
  \caption{Comparison of the DM approximation and the full model when mutation is included. Even high mutation rate doesn't worsen the approximation, and the data points are close to the mathematical estimation (Kimura's). Error bars are 95\% confidence intervals, and are condensed (+- 0.01 probability and +-40 generations)
  $5000$ simulations per data point, $N=1000$, $\alpha=0.1$,$\hat{A}=1$,$A=0.7$, $J\sim N(1,x^2)$ where $x$ is the mutation scale in the x-axis.
  }	
  \label{fig:hetro_mutation}
\end{figure}


In \cref{fig:hetro_mutation} we see the comparison when heterogeneous mutation is applied to both models. When mutation is applied, we sample $J_i$ for each copier $i$ from a normal distribution with varying scale (variance).
We can see that even when the standard deviation is $0.1$, the metrics of both models are both similar, and close to the Kimura approximation (more details in the next section). 

\begin{figure}
    \includegraphics[width=\linewidth]{../figures/binary/full_vs_dm_changing_alpha.pdf}
  \caption{Comparison of the DM approximation and the full model when success weight is heterogeneous. High success weight variance distances the approximation and the full model of generations to fixation from the Kimura's approximation, but not by much (confidence intervals still cover it). Error bars are 95\% confidence intervals, and are less condensed (+- 0.03 probability and +-40 generations)
  $5000$ simulations per data point, $N=1000$, $\alpha\sim N(0.5,x^2)$,$\hat{A}=1$,$A=0.7$, $J=1$, $\beta(A)=0.956$.}	
  \label{fig:hetro_alpha}
\end{figure}

In \cref{fig:hetro_alpha} we relaxed our assumption of a homogeneous $\alpha$, and used a heterogeneous $\alpha$ instead. Similar to the mutation comparison, we drew $\alpha_j$ for each role-model $j$ from a normal distribution with varying scale. We again see that the metrics of both models are similar in the entire spectrum of our x-axis, and the Kimura approximation is within both confidence intervals.

\subsection*{Fixation probability and time - binary model}
\paragraph{Kimura's approximation:}
After establishing a case in the favor of our DM approximation, we wanted to use it to examine the behavior of the population. Specifically, we wanted to analyze the influence of the indicator weight ($\alpha$) on the fixation probability and time to fixation of the favored phenotype in a binary model.
For simplicity, we don't include mutation rate in the binary model approximations.
Following \citet{durret}, we used our DM approximation of the model to find the effective population size. From \cref{eq:binary-model} we can derive that the process of inheritance in our binary model is DM distributed with a parameters vector of size two: $\vec{V}=(\alpha'X,(N-X)\alpha'\beta(A))$.

\begin{result}[Effective selection coefficient]
$1-\beta(A)$ is equivalent to the selection coefficient $s$ in a classic Wright-Fisher model in the diffusion equations meant to approximate the fixation probability and time of the advantageous trait.
\end{result}

\begin{proof}
Let $x$ be the frequency of type $\hat{A}$ in the population with $N$ individuals. Let $X$ be the number of individuals of type $\hat{A}$ so $x=X/N$. $X'$ is the number of individuals with $\hat{A}$ in the next generation and $x'$ their frequency.
By definition $\beta(\hat{A})=1$, and for simplicity we'll denote $\beta(A)=\beta$ ($\beta<1$).

The expected number of individuals of a DM distribution is:
\begin{equation}
E[X'] = N  \frac{\alpha_1}{\alpha_1+\alpha_2},
\end{equation}
where $\alpha_1 = \alpha' X$ and $\alpha_2 = \alpha'(N-X)\beta$, from  \cref{eq:binary-model}.
We want to use frequencies instead of quantities to follow Durret's process so:
\begin{equation}
E[x'] = E[\frac{X'}{N}] = \frac{1}{N}E[X']
\end{equation}
Putting it together we get:
\begin{equation}
\begin{split}
E[x'] &= \frac{1}{N}N\frac{\alpha' xN}{\alpha' xN + \alpha' N (1-x)\beta}\\
	 &= \frac{x}{x + (1-x)\beta}
\end{split}
\end{equation}

which is identical to the equation in the top of page 253, chap 7.2 in \citet{durret}. We therefore use the same approximation and say that:
\begin{equation}
\begin{split}
E[x'] =& \frac{x}{x + (1-x)\beta} = \frac{x}{x + (1-x)(1-s)} =\\
 &= x + x(1-x)s + o(s)\\
  &= x + x(1-x)(1-\beta) + o(1-\beta)
\end{split}
\end{equation}

By definition, $x$ is constant, so $E[x] = x$. We continue to calculate $E[x'-x]$:
\begin{equation}\label{eq:expec_freq}
E[x'-x] = E[x'] - E[x] = x(1-x)(1-\beta) + o(1-\beta)
\end{equation}
where when substituting $1-\beta$ with $s$, we get the same result as \citet{durret} which is the desired result.
\end{proof}

\begin{result}[Effective population size]
$N_e=\alpha N + (1-\alpha)$, where $Ne$ is the effective population size of our binary model.
\end{result}

\begin{proof}
The variance of a DM distribution is:
\begin{equation}
V(X') = N\frac{\alpha_1}{\alpha_1+\alpha_2}(1-\frac{\alpha_1}{\alpha_1+\alpha_2})
(\frac{N + \alpha_1+\alpha_2}{1+\alpha_1+\alpha_2})
\end{equation}
And again, we want to use frequencies so:
\begin{equation}
V(\frac{X'}{N}) = \frac{1}{N^2}V(x')
\end{equation}

Putting it together with our model's notations:
\begin{equation}
V(x') = \frac{1}{N^2}N\frac{x}{x+(1-x)\beta}(1-\frac{x}{x+(1-x)\beta})
(\frac{N + \alpha' xN + \alpha' N(1-x)\beta}{1 + \alpha' xN + \alpha' N(1-x)\beta}) 
\end{equation}

Like Durrett, we'll use the zero order of the approximation when $\beta\approx1$,so:
\begin{equation}
\frac{x}{x + (1-x)\beta} \approx x
\end{equation}
and we also use $\beta\approx1$ for the entire variance expression and get:
\begin{equation}
\begin{split}
V(x') & \approx  \frac{1}{N} x(1-x)
(\frac{N + \alpha' xN + \alpha' N - \alpha' xN}{1 + \alpha' xN + \alpha' N - \alpha' xN})\\
&=  x(1-x)(\frac{1 + \alpha'}{1 + \alpha' N}) 
\end{split}
\end{equation}

Again following Durrett we want to calculate:
\begin{equation}\label{eq:var_diff_durret}
V(x'-x) = V(x') - V(x) \approx  x(1-x)(\frac{1 + \alpha'}{1 + \alpha' N})
\end{equation}
because $x$ is a constant so $V(x) = 0$

In our model, $\alpha'$ is the odds ratio of a parameter we called "indicator weight", denoted in our model as $\alpha$, so:
\begin{equation}\label{eq:success_ratio}
\alpha' = \frac{\alpha}{1-\alpha}
\end{equation}

Combining \cref{eq:var_diff_durret} and \cref{eq:success_ratio} we get:
\begin{equation}\label{eq:const_var}
\begin{split}
V(x'-x) & \approx x(1-x)(\frac{1 + \frac{\alpha}{1-\alpha}}{1 + \frac{\alpha}{1-\alpha} N})\\
 &= x(1-x)(\frac{\frac{1-\alpha+\alpha}{1-\alpha}}{\frac{1-\alpha+\alpha N}{1-\alpha}})\\
 &= x(1-x)(\frac{1}{1- \alpha(1-N)})\\
  &= x(1-x)(\frac{1}{\alpha N + (1-\alpha)})\\
  &= x(1-x)\frac{1}{N_e}
\end{split}
\end{equation}

Using our substitute for a selection coefficient, $1-\beta$, and the effective population size $N_e$, we can estimate the fixation probability and time of our binary model.

The fixation probability derived from Kimura is therefore:
\begin{equation}\label{eq:kimura_p}
P_{fix} = \frac{1-e^{-2(1-\beta)N_e x}}{1-e^{-2(1-\beta)N_e}}
\end{equation}

where $x$ is the initial frequency of the advantageous phenotype $\hat{A}$.

The time to fixation can be estimated by:
\begin{equation}\label{eq:kimura_t}
T_{fix}=\frac{1-P_{fix}}{1-\beta}\int_0^x\frac{e^{2(1-\beta) \xi}-1}{\xi(1-\xi)}d\xi+ \frac{P_{fix}}{1-\beta}\int_x^1\frac{1-e^{-2(1-\beta)(1-\xi)}}{\xi(1-\xi)}d\xi
\end{equation}
where the integrals cannot be solved in closed form, so we can only estimate them numerically.

To validate our math we ran multiple simulations comparing our binary model with the classic Wright-Fisher model, using different $\alpha$ and $\beta$ each time, and using the corresponding values of $s$ and $N_e$ for the WF simulations.
In \cref{fig:var_alpha} we changed $\alpha$ (and $N_e$ accordingly) and used a constant $\beta$.
In \cref{fig:var_beta} we changed $\beta$ and used a constant $\alpha$.
In both cases we can see that the two models behave similarly, and both are approximated well by the Kimura's equations: \cref{eq:kimura_p} and \cref{eq:kimura_t}.


\begin{figure}[t]
  \begin{center}
  \begin{subfigure}[a]{0.49\linewidth}
    \caption{}
    \includegraphics[width=\linewidth]{../figures/binary/fix_prob_var_alpha.pdf}
   \end{subfigure}
   \begin{subfigure}[a]{0.49\linewidth}
     \caption{}
    \includegraphics[width=\linewidth]{../figures/binary/fix_time_var_alpha.pdf}
   \end{subfigure}
  \end{center}
  \caption{Comparison of the DM approximation and the WF model for different values of the effective population size. The approximation seems very good, and is also condensed around the mathematical equation expectancy. Error bars are 95\% confidence intervals.
  Effective population calculated by $N_e=\alpha N + (1-\alpha)$.
  $5,000$ simulations per data point, $N=1,000$, $\hat{A}=1$, $A=0.7$,$J=1$,$1-\beta=s=0.044$.}
  \label{fig:var_alpha}
\end{figure}

\begin{figure}[t]
  \begin{center}
  \begin{subfigure}[a]{0.49\linewidth}
  \caption{}
    \includegraphics[width=\linewidth]{../figures/binary/fix_prob_var_beta.pdf}
   \end{subfigure}
   \begin{subfigure}[a]{0.49\linewidth}
    \caption{}
    \includegraphics[width=\linewidth]{../figures/binary/fix_time_var_beta.pdf}
   \end{subfigure}
  \end{center}
  \caption{Comparison of the DM approximation and the WF model for different values of the selection coefficient, manifested as success bias in our model. The approximation seems good, and is also condensed around the mathematical equation expectancy. Error bars are 95\% confidence intervals.
  Effective population calculated by $N_e=\alpha N + (1-\alpha)$.
  $5,000$ simulations per data point, $N=1,000$, $\hat{A}=1$, $A=0.7$,$J=1$,$\alpha=0.01$.}
  \label{fig:var_beta}
\end{figure}

\subsection*{Changing environment}
After finding good estimations for our model in a constant environment, when the favorable trait is always $\hat{A}$, we want to find an estimation for our model in a changing environment.

For that we will find an expression for the expected and variance of the change in frequency between $t$ generations.
Let $s_t=N(1-\beta_t)$, and $S_n=\sum\limits_{i=1}^n s_i$, where $\beta_t$ is $\beta(A)$ at time/generation $t$.


\paragraph{Proposition:} $E[\frac{X_t}{N}-x]\simeq \frac{1}{N}S_tx(1-x)$ , $V(\frac{X_t}{N})\simeq\frac{1}{N_e}tx(1-x)$, where $x$ is the initial frequency of the favorable/invading trait and $X_t$ is the number of individuals with the trait at time $t$.

The proof is based on the proof of \citet{changeEnv}, proving a similar scenario.
\paragraph{Proof by induction:}
From \cref{eq:expec_freq} we know that
\begin{equation}\label{eq:ch_1}
\begin{split}
E\left[\frac{X_{t+1}}{N}-\frac{X_t}{N}\bigg|X_t\right] &= \frac{X_t}{N}\left(1-\frac{X_t}{N}\right)(1-\beta_{t+1}) \\
&= \frac{1}{N}\frac{X_t}{N}\left(1-\frac{X_t}{N}\right)s_{t+1}
\end{split}
\end{equation}
Also note that using the definition of $V(y)=E[y^2]-(E[y])^2$
\begin{equation}
\begin{split}
E\left[\frac{X_t}{N}\left(1-\frac{X_t}{N}\right)\right] &= E\left[\frac{X_t}{N}-\left(\frac{X_t}{N}\right)^2\right] \\
&= E\left[\frac{X_t}{N}\right]-E\left[\left(\frac{X_t}{N}\right)^2\right] \\
&= E\left[\frac{X_t}{N}\right] - V\left(\frac{X_t}{N}\right) - \left(E\left[\frac{X_t}{N}\right]\right)^2
\end{split}
\end{equation}

we can now use the induction assumption of $V(\frac{X_t}{N})$ and get
\begin{equation}
\begin{split}
E\left[\frac{X_t}{N}\left(1-\frac{X_t}{N}\right)\right] &\simeq
E\left[\frac{X_t}{N}\right]\left(1-E\left[\frac{X_t}{N}\right]\right)-\frac{1}{N_e}tx(1-x)
\end{split}
\end{equation}
From \cref{eq:ch_1} we know that
\begin{equation}
\begin{split}
E\left[\frac{X_{t+1}}{N}-\frac{X_t}{N}\right] &= \frac{1}{N}s_{t+1}E\left[\frac{X_t}{N}\left(1-\frac{X_t}{N}\right)\right] \\
&\simeq \frac{1}{N}s_{t+1}\left(E\left[\frac{X_t}{N}\right]\left(1-E\left[\frac{X_t}{N}\right]\right) - \frac{1}{N_e}tx(1-x)\right) \\
&\simeq \frac{1}{N}s_{t+1}\cdot E\left[\frac{X_t}{N}\right]\left(1-E\left[\frac{X_t}{N}\right]\right) - \frac{1}{N_e N}s_{t+1}tx(1-x)
\end{split}
\end{equation}
Now we'll omit $O(\frac{1}{Ne\cdot N})$ and get
\begin{equation}\label{eq:ch_2}
E\left[\frac{X_{t+1}}{N}-\frac{X_t}{N}\right] \simeq \frac{1}{N}s_{t+1}\cdot E\left[\frac{X_t}{N}\right]\left(1-E\left[\frac{X_t}{N}\right]\right)
\end{equation}

We'll now look at the induction assumption to see that
\begin{equation}
E\left[\frac{X_t}{N}-x\right]=E\left[\frac{X_t}{N}\right]-E[x]=E\left[\frac{X_t}{N}\right]-x ,
\end{equation}
so using the assumption we get
\begin{equation}
\begin{split}
E\left[\frac{X_t}{N}\right] &\simeq \frac{1}{N} S_t x(1-x)+x \\
1 - E\left[\frac{X_t}{N}\right] &\simeq 1- \frac{1}{N} S_t x(1-x)+x
\end{split}
\end{equation}
we'll use both expressions in \cref{eq:ch_2} and get
\begin{equation}\label{eq:ch_3}
\begin{split}
E\left[\frac{X_{t+1}}{N}-\frac{X_t}{N}\right] &\simeq \frac{1}{N}s_{t+1} \left(\frac{1}{N} S_t x(1-x)+x \right)\left(1- \frac{1}{N} S_t x(1-x)+x \right) \\
&\simeq  \frac{1}{N}s_{t+1}\cdot x(1-x)
\end{split}
\end{equation}
after again omitting $O(\frac{1}{N^2})$ parts of the equation.
To conclude our proof, we see that
\begin{equation}
E\left[\frac{X_{t+1}}{N}-x\right] = E\left[\frac{X_{t+1}}{N}-\frac{X_t}{N}\right] + E\left[\frac{X_t}{N}-x\right]
\end{equation}
so again using the induction assumption, together with \cref{eq:ch_3} we get
\begin{equation}
\begin{split}
E\left[\frac{X_{t+1}}{N}-x\right] &\simeq \frac{1}{N}s_{t+1}\cdot x(1-x) + \frac{1}{N}S_t\cdot x(1-x) \\
& \simeq \frac{1}{N}x(1-x)(S_t + s_{t+1}) \\
& \simeq \frac{1}{N} S_{t+1} x(1-x)
\end{split}
\end{equation}
which proves the first part of our preposition.

For the second part, we'll use a property of variance:
\begin{equation}\label{eq:ch_var}
V\left(\frac{X_{t+1}}{N}\right) = E\left[V\left(\frac{X_{t+1}}{N} \bigg|X_t \right)\right] + V\left(E\left[\frac{X_{t+1}}{N} \bigg|X_t \right]\right)
\end{equation}

using \cref{eq:ch_1} we see that:
\begin{equation}\label{eq:ch_var1}
\begin{split}
E\left[\frac{X_{t+1}}{N} \bigg|X_t \right] - E\left[\frac{X_{t}}{N} \bigg|X_t \right] &= \frac{1}{N}s_{t+1}\frac{X_t}{N}\left(1-\frac{X_t}{N} \right) \\
E\left[\frac{X_{t+1}}{N} \bigg|X_t \right] = \frac{X_t}{N} &+ \frac{1}{N}s_{t+1}\frac{X_t}{N}\left(1-\frac{X_t}{N} \right)
\end{split}
\end{equation}

Using \cref{eq:const_var} we get:
\begin{equation}
V\left(\frac{X_{t+1}}{N} \bigg|X_t \right) = \frac{1}{N_e}\frac{X_t}{N}\left(1-\frac{X_t}{N} \right)
\end{equation}

and using the equation $y'(1-y') \simeq y(1-y)$ on the first part of \cref{eq:ch_var} we get:
\begin{equation}\label{eq:ch_var2}
E\left[V\left(\frac{X_{t+1}}{N} \bigg|X_t \right)\right] = \frac{1}{N_e}E\left[\frac{X_t}{N}\left(1- \frac{X_t}{N}\right) \right] \simeq \frac{1}{N_e} x(1-x)
\end{equation}

and moving on to simplify the second part of \cref{eq:ch_var} using \cref{eq:ch_var1}:
\begin{equation}
V\left(E\left[\frac{X_{t+1}}{N} \bigg|X_t \right]\right) = V\left(\frac{X_t}{N} + \frac{1}{N}s_{t+1}\frac{X_t}{N}\left(1-\frac{X_t}{N} \right) \right)
\end{equation}

and now, because $\frac{X_t}{N}$ is a frequency, i.e $0\leq\frac{X_t}{N}\leq1$, we know that $V\left(\frac{X_t}{N}\left(1-\frac{X_t}{N} \right) \right)\leq\frac{1}{4}$. We therefore see that:
\begin{equation}
V\left(\frac{1}{N}s_{t+1}\frac{X_t}{N}\left(1-\frac{X_t}{N} \right) \right)\leq \frac{1}{4N^2}s^2_{t+1}
\end{equation}
and so it can be ignored.
Combining our equations we get:
\begin{equation}
V\left(E\left[\frac{X_{t+1}}{N} \bigg|X_t \right]\right) = V\left(\frac{X_t}{N}\right) + O\left(\frac{1}{N^2}\right)\simeq V\left(\frac{X_t}{N}\right)
\end{equation}

Using the induction assumption and \cref{eq:ch_var2}:
\begin{equation}
V\left(\frac{X_{t+1}}{N}\right) \simeq \frac{1}{N_e}x(1-x) + \frac{1}{N_e}tx(1-x) \simeq \frac{1}{N_e}x(1-x)(t+1)
\end{equation}
proving the second part of our preposition.
\end{proof}

Following our proof, we can say that after many cycles, we can use a modified version of our fixation probability:
\begin{equation}
P_{fix} = \frac{1-e^{-2 \frac{S_n}{n} N_e x}}{1-e^{-2 \frac{S_n}{n} N_e}}
\end{equation}
where $\frac{S_n}{n} = \frac{k-l}{k+l}(1-beta)$, $n=k+l$. Put into words, we use the average selection coefficient of a cycle ($k+l$) as the selection coefficient in our original equation.
In our proof we showed that the expected change in frequency and variance is only manifested in the selection coefficient $S_n$, and that we can use those modified equation as a base for Kimura's equation.

We wanted again to validate our results, using simulations.
This time, the number of parameters increased: in addition to $\alpha,\beta$, there are also $k,l$ as model parameters.

We again tried different variations of the parameters, changing only one of them at a time.
In \cref{fig:ch_env_alpha_beta} we can see that $\alpha$ on it's own doesn't cause any deviation for the the estimation. $\beta$ however affects the results greatly.

\begin{figure}[t]
  \begin{center}
  \begin{subfigure}[a]{0.49\linewidth}
  \caption{success bias/selection coefficient is: $1-\beta=s=0.005$}
    \includegraphics[width=\linewidth]{../figures/changed_env/ch_env_var_alpha.pdf}
   \end{subfigure}
   \begin{subfigure}[a]{0.49\linewidth}
   \caption{success weight is: $\alpha=0.1$}
    \includegraphics[width=\linewidth]{../figures/changed_env/ch_env_var_beta.pdf}
   \end{subfigure}
  \end{center}
  \caption{Model simulations compared with both the constant environment and the changing environment equations with different effective populations sizes and selection coefficients. Changing the effective population size doesn't affect the approximation, and it is condensed the mathematical expected values across all values. High values of success bias ($s>0.1$) will distance the simulations from the changing environment expected values. Very high values ($s>0.35$) will even deviate from the constant environment expected values. This is expected because Kimura's approximation are only viable for low selection coefficient values.
  $10,000$ simulations per data point, $N=1,000$, $\hat{A}=1$, $A=0.9$, $J=1$.}
  \label{fig:ch_env_alpha_beta}
\end{figure}

We plotted along the modified estimation the original Kimura's estimation, as a limiter. We suspect that when $\beta$ is too large, there won't be many cycles in the simulations. This might happen if either the population reaches a high frequency of the ideal trait after only a few cycles, or it get extinct very quickly, because the advantage it had in the $k$ generations wasn't sufficient, and the same $s$ becomes a greater disadvantage when the environment changes, resulting in a fast extinction.

In the larger values of $beta$ we even see a deviation from the original estimation environment, but it's to be expected, because Kimura's equations are only viable for small $s$ values.

We then also tried changing the composition of the cycle, by keeping a constant $n=40$, but changing $k,l$ accordingly.

\begin{figure}[t]
  \begin{center}
  \begin{subfigure}[a]{0.49\linewidth}
  \caption{}
    \includegraphics[width=\linewidth]{../figures/changed_env/ch_env_var_k_div_l.pdf}
   \end{subfigure}
   \begin{subfigure}[a]{0.49\linewidth}
   \caption{}
    \includegraphics[width=\linewidth]{../figures/changed_env/ch_env_var_k_min_l.pdf}
   \end{subfigure}
  \end{center}
  \caption{Model simulations compared with both the constant environment and the changing environment equations for different compositions of the environment cycle. When $k<l$ the approximation is good. When $k>l$, the approximation and the simulations are both very close to the constant environment approximation. 
  $10,000$ simulations per data point, $N=1,000$, $\hat{A}=1$, $A=0.8$, $J=1$, $1-\beta=s=0.02$, $\alpha=0.1$.}
  \label{fig:ch_env_k_l}
\end{figure}

In \cref{fig:ch_env_k_l} we see that the larger $k$ relative to $l$, the closer the modified equation is to the original estimation of the constant environment. 
When using higher values of $n$, the simulation results doesn't fit the equation result as with lower values. This is due to the fact that our proof, and therefore our equation is more accurate when more cycles occur. When $n$ is high, there will be less cycles, and the simulations will get closer to the constant environment equation.

\section*{Discussion}
\subsection*{summary}
Cultural transmission is the phenomenon of which cultural elements, in the form of attitudes, values, beliefs, and behavioral patterns, are transmitted between individuals, typically via copying.
Some cultural traits can be more likely to be copied by others, regardless of their frequency in the population.  
Such transmission biases are common in cultural transmission processes. 
Many models are based on the assumption that success can be correctly identified, and easily copied.
Here we assume that success isn't correctly identified, therefore individuals may use other indicators to try and estimate the success of potential role-models.
We believe, as \citet{complexityPaper} suggest, that \textit{prestige biases} are more common in nature than success biases, since estimating success accurately is harder.
\textbf{We investigated the effects of prestige on a population:} we studied the behavior of an invading trait, analyzed its dynamics mathematically, and extended the basic constant environment to a changing one.
We believe prestige is composed of two main components: a trait that indicates success (but doesn't guarantee it), and the influence the individual already has on others, i.e number of individuals already chose him as a role-model.
We suggest a model for \textit{prestige bias}, inspired by the model \citet{evolutionBook} have suggested, and added the \textit{influence bias} to it.
\textbf{We approximated our models using various distributions, and compared them to the original model using simulations.}
We showed that a \textit{Rich getting richer} type of model can be approximated well by the general binomial distribution and the dirichlet multinomial distribution.
We experimented with constant and changing environment in our model, and created a variation of a binary model for easier mathematical and computational analysis.
We believe that in this era of social media it is easy to estimate one's influence over others.
It is therefore crucial to model the cultural biases more realistically than success bias based model, and we believe including influence is crucial for that purpose.\\
\textbf{With a more realistic model of a common cultural transmission bias, we may be able to better understand decision-making processes in humans, including life-changing choices such as occupation or a life partner.} 
Our model can be expanded in multiple ways: observing the effects of different bias functions, including errors in estimating the influence, combining factors of cost when copying from an influential role model (not all could afford to copy from the most popular role-model), and analyzing the differences when including several optimal values for the indicator trait (multiple preference traits in the population).

\subsection*{Prestige in the literature}
So far we discussed prestige as a main bias in humans, and to some extent in non-human species. Here we further base our claims and present additional appearances of prestige in nature and in the literature. \\

\citet{animal_leadership} describe a manifestation of prestige in the form of leadership in animals. According to them, there are two main approaches to decision makings of groups in nature: leadership and consensus. Prey leaders would lead the pact when traveling, while other animal group leaders will decide on a nesting site or foraging patches. They found out that leadership is observed mostly when there is a profound social network in the group, and when there are individuals that present leadership behavior. Leaders would usually be high ranking members in the group, such as elders, individuals with many kin relations, or posses other dominant traits. When no individual posses such traits, or when the social network is lacking, a consensus is more likely to occur.
When a leader is present, they will have greater selection costs, such as higher risk for predation, being poisoned by unknown experimental patch, but also greater benefits. For example, given the route to the foraging site was successful, the leader and his closest followers would gain most of the food, unlike in a consensus, where the food would be shared more equally.
It appears leaders appear in simple organisms as well, like fish. In these organisms however, the leader would usually be the hungriest or the weakest, while the rest would prefer to follow, minimizing their costs. In baboons however, \citet{animal_leadership} describe many benefits for the closest associates of the dominant male, such as protection from predators. This is an instance of sexual-selection, where the leader, whose survival chances are lower, gains more sexual partners due to the benefits. ("The greater the risk, the greater the reward")
What they describe could be the origins of what we know today as prestige. In their paper, they show that in nature, when survival is the main concern at all times, the leaders wouldn't be chosen due to their superior abilities, but because they have the least to lose. When in said position of leadership, there are greater risks, but greater rewards to come with it. 
In humans, leadership also has its perks and costs. Leaders can make decisions that would benefit them and their closest followers the most, while still maintaining group cohesion. However, wrong decision making that would harm the group could result in harm (media, social status, even violent behavior of subjects on certain cases).
In our society it is less common to worry about mere survival, and so the prestigious positions, even though are not without risks and costs, are not as dangerous as for animals in nature. This may be the reason humans strive for the prestigious positions, as they may reap rewards greater than the risk and costs to achieve them. This is in complete contrast to animals, where the weakest/hungriest is driven to lead, compared to humans where leadership positions are mostly competitive.\\

\citet{dual_leadership} suggest a different view of leadership. They note that most discussions assume there is one type of leadership, as seen above, and so they differ in their definitions. \citet{dual_leadership} suggest a way to solve said contradiction by defining two types of leaderships: prestige-based and dominance-based.
They present classical views of leaderships by Confucius and Machiavelli. Confucius views leaders as role models who exercise influence through possessing superior knowledge, skills,
and (outstanding) personal qualities. This description is very similar to our indicator trait. By contrast, Machiavelli views leaders as rulers who exercise influence by imposing costs through (the threat of) punishment. They say that these two opposing views are both partially supported by the available evidence but each one on its own offers an incomplete view into the complex and dynamic processes of leadership. 

Our current model doesn't reflect the model described in this article, but several adjustments could be made in order to match it. If we assume there's a correlation between trait value to a type of leadership (so in our binary model, one trait would be of prestige, and the other of dominance) we can implement their suggested model. For that we would need to add cost-benefit parameters, so the ones choosing prestige will be rewarded, but pay more, while the ones choosing dominance would pay less, but gain less benefits. It could be interesting to see the dynamics and relations between our model parameters and these cost-benefit parameters.\\

\citet{prestige_evolution} support said claim that there are two types of leadership, and also define the two as prestige based and dominance based leadership types.
By their definition, the latter is defined by acquiring social status by using aggression, intimidation and violence. It is also more common than prestige in non humans. Their definition of prestige is somewhat synonymous with ours. According to their manuscript, prestige is composed both of estimation in the eyes of people (our indicator/success trait) and commanding position in people's minds, i.e number of copiers people think they have, which they define as \textit{influence} (similar to our definition for influence).
In their paper, they show that prestige evolved from natural selection, as an efficient process to extract reproductive benefit from the flow of socially transmitted information. Simply put, prestige is a natural step where social learning exists, due to saving costs of individual learning.
It could be interesting in the future to expand our model using this idea: observing the copier trait of \textit{evaluation}, rather than only observing the evolution of the indicator trait copied.
\citet{prestige_evolution} suggest that the most skilled role-models will, on average, end up with most copiers. Their research, definitions and results, is consistent with ours.\\

So far we presented the theory behind prestige, and it's appearance in nature. The following will show the appearances of prestige biases in humans, and in recent times.

\citet{prestige_cultural_learning}, for example, tested the existence of prestige in young children. \citet{prestige_cultural_learning} report the first direct tests in children that suggest the existence of \textit{prestige bias}, a tendency to learn from individuals to whom others have preferentially attended, learned or deferred.
Their definition of prestige is similar to our \textit{influence bias}, and brings concrete proof of its existence and effects. Their study showed that the odds of 3-4 years-old children learning from an adult model to whom bystanders had previously preferentially attended for 10 seconds were over twice those of their learning from a model whom bystanders ignored.
In addition to this first study, they also discovered prestige effects are domain-sensitive. They saw that prestigious models were listened to by most when demonstrating artifact-use, but not as much as when presenting food preferences. It lead \citet{prestige_cultural_learning} to believe that when the trait is costly to learn individually, prestige will have a higher effect. It would be interesting to include costs in our model to try and observe these effects and their dynamics in the simulations of a larger population than this study.\\

\citet{fijian_social_bias} researched Fijian villages, looking for evidence of social learning biases and their origins. They mention that:
\begin{quote}
evolutionary theorists propose that natural selection has favored the emergence of psychological biases for learning from those individuals most likely to possess adaptive information.
\end{quote}
Their goal is to bridge from the laboratory to the field by examining if and how these biases emerge in a small-scale society.
During their research they found that:
\begin{quote}
Fijian villagers (ages 10 and up) are biased to learn from others perceived as more successful/knowledgeable, both within and across domains (prestige effects).
\end{quote}
Their research shows promising evidence for our prestige model, suggesting that copying from others who are \textit{perceived} as successful, rather than actually are successful. In their paper, they show that the social networks representing copier-role-model relationships are centralized, suggesting:
\begin{quote}
This degree of centralization is consistent with the prediction that people substantially share notions about who is a good cultural model (network centrality), but that individuals’ model selections are influenced by multiple factors.
\end{quote}
We see here support for both our indicator trait and our influence bias in their data.\\

Aside from children's learning biases and small villages in a relatively primitive population, we can see prestige in more advanced domains as well, like western medicine.\citet{medical_prestige} present a specific and important effect of prestige - its significance for medical specialties and diseases.
They examined literature from 1950 to 2005 regarding the effects of prestige on medicinal practices. They discovered that active, specialized, biomedical, and high-technological types of medicine on organs in the upper part of the bodies of young and middle-aged people were accorded high levels of prestige, while medicine with opposite characteristics had low levels of prestige. They have concluded that such differences in prestige bear consequences for actual priority setting in healthcare systems. They discovered that surgery counts as the most prestigious specialty, while psychiatry is the less prestigious. In addition, doctors tend to rank practices that require more time to master as more prestigious, while other procedures that are considered \textit{easier} are less prestigious. Simply put, they found that the advance in technology and research was in accordance with the prestige rankings.
This means that there may be very important practices that are neglected due to the prestige bias.\\

As we seen so far, prestige can explain many behaviors and evolution of cultural traits. It is a tool to cheaply estimate and acquire knowledge, which helps an individual to survive and breed. However, it is not always the case, and there could be negative repercussions to this bias, such as invasion of maladaptive traits.

\citet{best_of_k} mention that social learning not only takes the form of random copying of other individuals, but also involves learners’ choice of what to learn and from whom to learn. They suggest a best-of-K model where an individual samples k role-models and choose the one he deems most "successful". They mentioned that a previous mathematical analysis has shown that it may sometimes result in maladaptive cultural evolution when the payoffs associated with cultural variants vary stochastically. In such a case, learners may be selectively disfavored and in the long run replaced by unbiased learners, who simply copy someone chosen at random. They develop new mathematical models that are simpler and mathematically tractable. They found that best-of-k learning, unlike unbiased learning, can facilitate the invasion of an on average inferior variant that sometimes gives a very high payoff. Our model, which includes influence bias, is consistent with that claim. When a maladaptive trait is "piggybacking" a role-model with high influence, said trait could spread in the population, as mentioned. In addition, they show that best-of-k learning can be stable against invasion by unbiased learning if social learning is sometimes combined with individual learning. Our model is based on copying based learning only, but it could be interesting to combine it with individual learning and see how it affects the dynamics of the population.

We discussed prestige in depth, and provided several proofs for its existence in nature, humans, and even medicine. We saw it could aid invasion of maladaptive traits, or neglect of important medicinal specialities. But, it can also accelerate reversal of harmful traditions.
Harmful traditions can be child marriage, open defecation, and domestic violence, to name a few. 
\citet{harmful_traditions} suggest a mechanism called \textit{spillover}. By their definition, a spillover is when an intervention affect a large enough group in a target population, so that others not included in the intervention starts changing their behavior as well. In their research, they found that there are individuals who act as \textit{agents}, who are often looked upon, and therefore they are ideal targets for interventions. This is the same concept as our role-models, where a more prestigious individual will be copied more, therefore spreading his trait wider in the population. Their research support therefore in our assumption that there are social biases, conformist influence specifically. They also suggest a way to use this phenomena to change existing traditions in a population. It is very clear however, that just as it can be used to end harmful traditions, the same agents could be used for any negative way that comes to mind.\\

Up until now, we showed that cultural transmission is a process that manifests in many species, with emphasis on humans. We also displayed similarities between this process and genetic transmission, while presenting differences between them, specifically selective biases such as influence and prestige. We also presented examples of good and bad usages of such biases. All of these are mainly presented as a parallel process to the natural selection process in regards to physical anatomy, or at least have an indirect effect on it. \citet{collective_brains} offer a take on prestige as a factor of human physical evolution directly. They present a concept called \textit{cultural brains} - brains that evolved primarily for the acquisition of adaptive knowledge.
They build on the hypothesis of \citet{social_brains} that shows that larger, more complex brains can store and manage more information and in turn, this information can support the costs of a larger brain.
\citet{collective_brains} built a model that predicts a strong relationship between brain size and group size, because group size also provides access to more adaptive knowledge. They later present their \textit{cumulative cultural brain} hypothesis, an approach which proposes that human brains have evolved with an ability and proclivity for selective, high fidelity social learning. As part of this process, there are a variety of strategies and biases that have evolved to hone in on the most adaptive knowledge. These strategies and biases include direct and indirect cues of the popularity of cultural traits (e.g. success and prestige biases).
In short, they suggest that some of the reasons for the extreme increase in brain size in humans, are the ability to "cheaply" acquire adaptive knowledge, i.e transmission biases, such as prestige.

\pagebreak
\bibliography{refs}
\bibliographystyle{apalike}
\end{document}
